% !TeX root = ../main.tex
% Add the above to each chapter to make compiling the PDF easier in some editors.

\chapter{Background}\label{chapter:background}
In this chapter, the theoretical background of time-reversal imaging and rays as model for electromagnetic waves according to Maxwell's equations is presented.
These two concepts are essential for understanding the time-reversal imaging process proposed in this thesis and its underlying physical principles. 

\section{Time-Reversal of the Electromagnetic Field}
\subsection{Time-Reversal Invariance of Physical Laws}
The evolution of a physical system in time can be described by a trajectory \(s(t) \in \mathbb{P}\) in a state-space \(\mathbb{P}\).
This state-space is a high-dimensional space, where each dimension represents a physical property (e.g.~mass, velocity, kinetic energy etc.) of each component of the system.
It should not be confused with the physical space.
In general the time-reversal transformation consists of two components~\parencite{roberts_reversing_2022}.
First, the trajectory \(s(t)\) has to be time-reversed by \(s(t) \mapsto s(-t)\).
This means, that the sequence of the states is reversed with respect to time.
This alone is not sufficient as the properties of the states have to be time-reversed as well.
In a second step, a time-reversal operator has to be applied to each individual instantaneous state \(s(-t) \mapsto \mathcal{T}s(-t)\), e.g.\ a ball with velocity to the right would become a ball with velocity to the left.
The time-reversal operator acts by either reversing (momentum) or preserving (kinetic energy) the properties.
In summary, time reversing \(s(t)\) results in the trajectory \(r(t)=\mathcal{T}s(-t)\). 
As \(s(t)\) is an observable trajectory in the physical world, it is a solution to the equations given by the laws that describe the system. 
A law being time-reversal invariant implies that the time-reversed curve \(r(t)\) is also a solution to this law~\parencite{roberts_time_2021}.

\begin{figure}[ht]
    \centering
    \begin{minipage}{0.34\textwidth}
        \centering
        \def\svgwidth{\textwidth}
        \input{build/PhasePlot.pdf_tex}
        \def\svgwidth{\textwidth}
        \input{build/Pendulum.pdf_tex}
    \end{minipage}
    \begin{minipage}{0.2\textwidth}
        \centering
        \def\svgwidth{\textwidth}
        {\Huge \input{build/TRimplication.pdf_tex}}
    \end{minipage}
    \begin{minipage}{0.34\textwidth}
        \centering
        \def\svgwidth{\textwidth}
        \input{build/PhasePlotTimeReversed.pdf_tex}
        \def\svgwidth{\textwidth}
        \input{build/PendulumTimeReversed.pdf_tex}
    \end{minipage}
    \caption{The phase state of the pendulum contains the position specified by the angle \(\Theta \) between the pendulum and the vertical line that extends directly downward from the pivot point and the angular velocity of the pendulum \(\frac{d\Theta}{dt}\). Time-reversing this trajectory in the phase portrait means reversing the flow direction and mirroring the trajectory at the \(\Theta \)-axis.}\label{fig:phase_plot}
\end{figure}

For a more hands-on example, imagine filming a pendulum that is influenced by gravity.
Newtons second law \(F=ma\) is time-reversal invariant. 
This means the film can be played backwards and the trajectory of the pendulum will still follow Newtons second law (see Figure~\ref{fig:phase_plot}).
An example for a non time-reversal invariant law is the second law of thermodynamics, which states that the entropy of an isolated system never decreases.
This means, that a film of a gas spreading out in a room played backwards would not comply to this law, as the entropy of the system in the backwards film actually decreases by time.

\subsection{Time-Reversal Invariance of Maxwell's Equations}
Maxwell's equations formulate the foundations of classical electromagnetism.
They relate the electric field \(\bm{E}\), the electric displacement field \(\bm{D}\), the magnetic field \(\bm{H}\), the magnetic flux density \(\bm{B}\), the electric charge density \(\rho \) and the electric current density \({\bm{J}}\).
Generally \(\bm{E}\) and \(\bm{D}\) are further related by the electric permittivity \(\varepsilon \), while \(\bm{H}\) and \(\bm{B}\) are related by the magnetic permeability \(\mu \).
In this paper only time-invariant, reciprocal and anisotropic media are considered, which means that the permittivity \(\varepsilon \) and the permeability \(\mu \) are hermitian tensors~\parencite{krowne_electromagnetic_1984}.
This leads to a reduced form of Maxwell's equations, which are given by
\begin{align}
    \begin{split}
        \nabla \cdot (\varepsilon \bm{E}) &= \rho, \\
        \nabla \times \bm{E} &= -\mu \frac{\partial \bm{H}}{\partial t},
    \end{split}
    &
    \begin{split}
        \nabla \cdot (\mu \bm{H}) &= 0, \\
        \nabla \times \bm{H} &= \bm{J} + \varepsilon \frac{\partial \bm{E}}{\partial t}.
    \end{split}
\end{align}

For the time-reversal of these equations, one first has to understand, how the time-reversal operator \(\mathcal{T}\) acts on the fields \(\bm{E}\) and \(\bm{H}\).
Taking into account, that the Poynting vector \(\bm{S} = \bm{E} \times \bm{H}\) is a measure for the energy flow of the electromagnetic field, the time-reversal of these fields has to be chosen in a way that the Poynting vector is reversed as well.
This means, that either \(\bm{E}\) or \(\bm{H}\), but not both, have to be reversed so the Poynting vector changes sign. 
The Maxwell equations remain invariant if the fields and densities are transformed by~\parencite{sigwarth_time_2022}
\begin{align}
    \begin{split}
        \mathcal{T}\bm{E} &= \bm{E}, \\
        \mathcal{T}\rho &= \rho, \\
    \end{split}
    &
    \begin{split}
        \mathcal{T}\bm{H} &= -\bm{H}, \\
        \mathcal{T}{\bm{J}} &= -{\bm{J}}.
    \end{split}
\end{align}

An intuitive but not rigorous explanation for this transformation is given by the fact, that the electric field is a measure for the force acting on a charge, while the magnetic field is a measure for the force acting on a moving charge. 
Accordingly if time is reversed, the direction of the charges will revert and hence the magnetic field should revert. 
In contrast there is no reason for a positive charge to become a negative charge and vice versa, so the electric field stays the same.

With the time-reversal operator defined for all components of Maxwell's equations the time-reversal of the electric and magnetic field in the time domain can now be written as
\begin{equation}
    \bm{E}_{\text{TR}}(t) = \bm{E}(-t) \quad \text{and} \quad \bm{H}_{\text{TR}}(t) = -\bm{H}(-t).
\end{equation}

The Fourier transformation of these equations with \(\mathcal{F}\{X(t)\} = \hat{X}(\omega) = \int X(t) \mathrm{e}^{\mathrm{i}\omega t} \, dt\) leads to
\begin{equation}
    \hat{\bm{E}}_{\text{TR}}(\omega) = \hat{\bm{E}}{(\omega)}^* \quad \text{and} \quad \hat{\bm{H}}_{\text{TR}}(\omega) = -\hat{\bm{H}}{(\omega)}^*,
\end{equation}
where \(^*\) denotes the complex conjugate. 
As only fields in the frequency domain will be considered in the following, the hat is dropped.



\section{Reciprocity and Time-Reversal}\label{sec:math_foundations_em_tr}
In \parencite{de_rosny_theory_2010} the mathematical groundwork for the time-reversal of electromagnetic waves has been laid out.
This section does not cover the derivation of their results, but review them as they represent the starting point of mathematical justification for the time-reversal of electromagnetic waves.

\subsection{The Six-Vector Formalism}
In~\parencite{de_rosny_theory_2010} two formalisms are introduced to simplify the notation of the electromagnetic field and its sources in the context of time-reversal and reciprocity.
The electric and magnetic field are combined into the  six-vector \(\psi \) which is defined as
\begin{equation}
    \psi(\bm{r}) = \begin{pmatrix}
        \bm{E}(\bm{r}) \\
        \mathrm{i} \bm{H}(\bm{r})
    \end{pmatrix}
\end{equation}
and a source vector \(q\) is defined as
\begin{equation}
    q(\bm{r}) = \begin{pmatrix}
        -\mathrm{i} \bm{J}(\bm{r}) \\
        \bm{M}(\bm{r})
    \end{pmatrix}
\end{equation}
with \(\bm{J}\) and \(\bm{M}\) denoting the electric and magnetic current density vectors.
This definition makes sure, that the the time reversal operator \(\mathcal{T}\) acts on \(\psi \) and \(q \) by simple complex conjugation, therefore
\begin{equation}
    \mathcal{T}\psi = \psi^* \quad \text{and} \quad \mathcal{T}q = q^*.
\end{equation}

These vector-distributions are furthermore linearly related through the Green's function \(G\) of the system
\begin{equation}
    \psi(\bm{r}) = \int G(\bm{r}, \bm{r}^{\prime}) q(\bm{r}^{\prime}) \, d^3 r^{\prime},
\end{equation}
which is a \(6 \times 6\) matrix.
For improved readability the integral is written in the following way
\begin{equation}
    \int G(\bm{r}, \bm{r}^{\prime}) q(\bm{r}^{\prime}) \, d^3 r^{\prime} = [G(\bm{r}) q].
\end{equation}

This formalism is introduced to rewrite the reciprocity theorem for two sets of sources \(\bm{J}_1, \bm{M}_1\) and \(\bm{J}_2, \bm{M}_2\), and their corresponding fields \(\bm{E}_1, \bm{H}_1\) and \(\bm{E}_2, \bm{H}_2\)~\parencite[p.~146]{balanis_antenna_2005},
\begin{equation}
    \int (\bm{E}_2 \cdot \bm{J}_1 - \bm{H}_2 \cdot \bm{M}_1) \, d^3 r = \int (\bm{E}_1 \cdot \bm{J}_2 - \bm{H}_1 \cdot \bm{M}_2) \, d^3 r
\end{equation}
as
\begin{equation}\label{eq:reciprocity_theorem}
    \int \psi_2 q_1 d^3 r = \int \psi_1 q_2 d^3 r.
\end{equation}

To further simplify the notation, the cross-product of a three dimensional vector \(\bm{N}\) and a six dimensional vector consisting of two three dimensional vectors \(\bm{A}\) and \(\bm{B}\) is defined as
\begin{equation}
    \bm{N} \times \begin{pmatrix}
        \bm{A} \\
        \bm{B}
    \end{pmatrix} = \begin{pmatrix}
        \bm{N} \times \bm{B} \\
        \bm{N} \times \bm{A}
    \end{pmatrix}.
\end{equation}

\subsection{The Electromagnetic Time-Reversal Equation}
\begin{figure}
    \centering
    \def\svgwidth{0.35\textwidth}
    \input{build/ClosedSurface.pdf_tex}
    \caption{The receivers (green) form a closed surface \(\delta \Gamma \) that contains all the sources (purple) inside.}\label{fig:closed_surface}
\end{figure}

Under the assumption of a reciprocal environment (\(\varepsilon \) and \(\mu \) are hermitian) the following equation can be derived from the reciprocity theorem~\eqref{eq:reciprocity_theorem}:
\begin{equation}\label{time-reversal-equation}
    \begin{aligned}
    & \underbrace{\oint_{\delta \Gamma} G(\bm{r}^{\prime}, \bm{r}) {\left(\bm{n}\left(\bm{r}^{\prime}\right) \times  \psi(\bm{r}^{\prime}) \right)}^* d^2 \bm{r}^{\prime}}_{\psi_S(\bm{r})} \\
    &=\underbrace{[G^*(\bm{r}) q^*] - [G(\bm{r}) q^*]}_{\psi_V(\bm{r})}
    \end{aligned}
\end{equation}
This derivation is properly laid out  in \parencite{de_rosny_theory_2010} and is not repeated here.
The left-hand side \(\psi_S(\bm{r})\) can be interpreted as a procedure of four steps:
\begin{enumerate}
    \item Record the field \(\psi(\bm{r}^{\prime}) \) at the closed surface \(\delta \Gamma \).
    \item Deduce an equivalent source distribution \(q(\bm{r}^{\prime})\) from the recorded field on the surface \(\delta \Gamma \) according to the normal vector \(\bm{n}(\bm{r})\) of the surface: 
    \begin{equation}
        q(\bm{r}^{\prime}) = \bm{n}(\bm{r}^{\prime}) \times \psi(\bm{r}^{\prime})
    \end{equation}
    \item Time-reverse these sources:
    \begin{equation}
        q_{\text{TR}}(\bm{r}^{\prime}) = \mathcal{T}q(\bm{r}^{\prime}) = {q(\bm{r}^{\prime})}^*
    \end{equation}
    \item Calculate the electromagnetic field \(\psi_S(\bm{r})\) generated by this time-reversed source distribution:
    \begin{equation}
        \psi_S(\bm{r}) = \oint_{\delta \Gamma} G(\bm{r}^{\prime}, \bm{r}) q_{\text{TR}}(\bm{r}^{\prime}) d^2 r^{\prime}
    \end{equation}
\end{enumerate}
The electromagnetic time-reversal equation~\eqref{time-reversal-equation} then states that this recreated field on the left side \(\psi_S(\bm{r})\) equals the time-reversed version of the measured field (which is of interest)
\begin{equation}
    \psi_{\text{TR}}(\bm{r}) = \psi{(\bm{r})}^* = [G^*(\bm{r}) q^*],
\end{equation}
minus a diverging field
\begin{equation}
    A(\bm{r}) = [G(\bm{r}) q^*].
\end{equation}

The time limit of the diverging field \(A(\bm{r})\) to infinity is zero because the sources are initially turned off, so their time-reversed excitation and thus the field \(A\) goes to zero after a certain time resulting in
\begin{equation}
    \psi_S(\bm{r}) = \psi_{\text{TR}}(\bm{r}).
\end{equation}

Therefore the time-reversed electromagnetic field \(\psi_{\text{TR}}\) inside of a volume \(\Gamma \) can be obtained from the fields \(\psi \) at a closed surface \(\delta \Gamma \) that contains all the sources.
This is done by applying the time-reversal operator \(\mathcal{T}\) to these fields and emitting the resulting sources back into \(\Gamma \).



\section{Time-Reversal Imaging}
This section is dedicated to the explanation of how time-reversal is used for imaging through inverse scattering.
Inverse scattering focuses on identifying the characteristics of an unknown scatterer, including its form, location, and material composition, based on the information obtained from measured scattered fields.
The focus of this thesis is on the localization of passive targets, which are scatterers that do not emit any electromagnetic waves and only re-radiate induced surface currents.
This problem is closely related to active-source localization, as the scattered field produced by passive targets can be interpreted as the radiated field from a source at the scatterer location~\parencite{chen_computational_2018}.

\subsection{Active-Source Localization}
Assuming that \(N\) point-sources, denoted as \(q_i(\omega)\), are located at positions \(\bm{r}_i\), the source-distribution \(q(\bm{r}, \omega)\) is obtained
\begin{equation}
    q(\bm{r}, \omega) = \sum_{i=1}^{N} \delta(\bm{r} - \bm{r}_i) q_i(\omega),
\end{equation}
with \(\delta(\bm{r}) \) denoting the dirac delta-function.
To explain how the described time-reversal process can be used for active-source localization, a signal theory approach is taken.
To do this the medium is modelled as a reciprocal LTI-System.
Now the propagation of an electromagnetic wave-signal \(\psi(\bm{r}, \omega )\) from a source \(q_a(\omega )\) at \(\bm{r}_a\) to a receiver at \(\bm{r}_b\) can be reduced to a simple input-output system with the transfer function \(H_{a\rightarrow b}(\omega)\) that models the impact of a source at location \(\bm{r}_a\) on the field at location \(\bm{r}_b\) in the system.
\begin{equation}
    \psi(\bm{r}_b, \omega) = H_{a\rightarrow b}(\omega) q_a(\omega)
\end{equation}
This can be applied to the whole source distribution \(q(\bm{r}, \omega)\) to obtain the wave-signal at the receiver \(\bm{j}\).
\begin{equation}
    \psi(\bm{r_j}, \omega) = \sum_{i=1}^{N} H_{i\rightarrow j}(\omega) q_i(\omega)
\end{equation}
From this wave-signal, an equivalent source 
\begin{equation}
    p_j(\omega) = \bm{n}(\bm{r}_j) \times \psi(\bm{r}_j, \omega)
\end{equation}
can be deduced, where \(\bm{n}(\bm{r}_j)\) is the normal of the measurement surface. 
This is done at all \(M\) receivers at the locations \(\bm{r}_j\), expressed by applying the measurement operator \(\mathcal{M}\) to all the fields at the receiver locations.  
\begin{align}
    [p_1(\omega), p_2(\omega), \ldots, p_M(\omega)] &= \mathcal{M} [\psi(\bm{r}_1, \omega), \psi(\bm{r}_2, \omega), \ldots, \psi(\bm{r}_M, \omega)] \\
                                                    &= [\mathcal{M}_1 \psi(\bm{r}_1, \omega), \mathcal{M}_2 \psi(\bm{r}_2, \omega), \ldots, \mathcal{M}_M \psi(\bm{r}_M, \omega)]
\end{align}
This step is a discretization of the integral over the closed surface \(\delta \Gamma \) in the time-reversal equation~\eqref{time-reversal-equation}.
Time-reversing (complex-conjugating) the measured sources at all the receivers and remitting them will result in the wave-signal distribution
\begin{align}
    \psi_{\text{TR}}(\bm{r}_x, \omega)  &= \sum_{j=1}^{M} H_{j\rightarrow x}(\omega) p_j^*(\omega) \\
                                        &= \sum_{j=1}^{M} H_{j\rightarrow x}(\omega) {\mathcal{M}_j}^* \psi^*_i(\bm{r}_j, \omega) \\
                                        &= \sum_{j=1}^{M} \sum_{i=1}^{N} H_{j\rightarrow x}(\omega) {\mathcal{M}_j}^* \bm{H}^*_{i\rightarrow j}(\omega) q^*_i(\omega). \label{eq:signal-time-reversal}
\end{align}

At this point it should be mentioned, that the usage of \(\psi \), \(q\) and the relating measurement operator \(\mathcal{M}\) was chosen for consistency with Section~\ref{sec:math_foundations_em_tr}.
In most papers about electromagnetic time-reversal only the co-polarized electric field component \(\bm{E}\) is considered for simplicity.
Then, by substituting \(\bm{E}\) for \(\psi \) and describing the sources \(q_i\) by the co-polarized electric field component \(\bm{E}_i\) they cause at location \(\bm{r}_i\) (i.e.~\(\mathcal{M}=\mathcal{I}\)), equation~\eqref{eq:signal-time-reversal} becomes
\begin{equation}\label{electric-time-reversal}
    \bm{E}_{\text{TR}}(\bm{r}_x, \omega) = \sum_{j=1}^{M} \sum_{i=1}^{N} H_{j\rightarrow x}(\omega )  \bm{H}^*_{i\rightarrow j}(\omega) \bm{E}^*_i(\omega)
\end{equation}
This approach is valid if the receivers are located in the far-field of the sources.
Here the electric and magnetic fields are orthogonal, so it is sufficient to only keep track of the electric field.
Furthermore the deduction of an equivalent source \(q_{\text{TR}}(\bm{r}) = n(\bm{r}) \times \psi(\bm{r})\) can be simplified so the electric and magnetic current densities are proportional to the electric and magnetic field respectively~\parencite{de_rosny_theory_2010}:
\begin{equation}
    q_{T R}(\bm{r})= \begin{pmatrix}
        -\mathrm{i} \bm{J}^*(\bm{r}) \\
        m^*(\bm{r})
    \end{pmatrix} =\left(\begin{array}{c}
        \mathrm{i} \bm{E}^*(\bm{r}) / \eta \\
        \eta \bm{H}^*(\bm{r})
        \end{array}\right)
\end{equation}
At any source location \(\bm{r}_k\) equation~\eqref{electric-time-reversal} becomes
\begin{equation}\label{electric-time-reversal-source}
    \bm{E}_{\text{TR}}(\bm{r_k}, \omega) = \underbrace{\sum_{j=1}^{M} H_{j\rightarrow k}(\omega) \bm{H}^*_{k\rightarrow j}(\omega) \bm{E}^*_k(\omega)}_{\text{constructive}} + \underbrace{\sum_{\substack{i=1 \\ i \neq k}}^{M} \sum_{i=1}^{N} H_{j\rightarrow x}(\omega ) \bm{H}^*_{i\rightarrow j}(\omega) \bm{E}^*_i(\omega)}_{\text{destructive}}
\end{equation}
As mentioned before, the system is reciprocal so \(H_{j\rightarrow k}(\omega )= H_{k\rightarrow j}(\omega )\). 
Therefore the Constructive part is equal to \(|H_k(\omega)|^2 \bm{E}^*_k(\omega)\), with
\begin{equation}
    |H_k(\omega)|^2 = \sum_{j=1}^{M} |H_{j\rightarrow k}(\omega)|^2
\end{equation}
This means the constructive part reconstructs the time-reversed signal at the source location \(\bm{r_k}\) without any phase distortion (\(\Im \{{|H_k(\omega)|^2}\} = 0\)) and an attenuation factor of \(|H_k(\omega)|^2\).
Conversely the destructive part is the sum of all cross-terms of the transfer functions \(H_{j\rightarrow k}(\omega)\) and \(H_{i\rightarrow j}(\omega)\) with \(i \neq k\) that tend to be less intense than the constructive terms if the number of receivers goes to infinity.

If~\eqref{electric-time-reversal} is evaluated at any non-source location, no constructive part will arise, hence the time-reversed signal at this location will be significantly less intense than at the source locations.
With this in mind one can see how equation~\eqref{electric-time-reversal} approximates the time-reversed active-source distribution. 
\begin{equation}
    \bm{E}_{\text{TR}}(\bm{r}, \omega) \approx \bm{E}_{\text{TR-source}}(\bm{r}, \omega) =  \sum_{i=1}^{N} \delta(\bm{r}-\bm{r}_i) \bm{E}^*_i(\omega)
\end{equation}

\subsection{Monochromatic Signals}
Although there are quite promising attempts of improving the imaging from the reconstructed time-reversed field by using time-domain techniques, like a correlation-based criteria~\parencite{li_correlation-based_2021}, the focus of this thesis will remain on the frequency-domain using monochromatic signals.
These are defined by their amplitude \(|\bm{E}|\) and phase \(\varphi \) at a single frequency \(\omega \) and are usually described by a complex phasor \(\underline{\bm{E}}(\bm{r})\).
\begin{equation}
    \underline{\bm{E}}(\bm{r}) = |\bm{E}(\bm{r})| \mathrm{e}^{\mathrm{i} \varphi(\bm{r})} = |\bm{E}(\bm{r})| (\cos(\varphi(\bm{r})) + \mathrm{i} \sin(\varphi(\bm{r})))
\end{equation}
The time-domain representation of the signal at location \(\bm{r}\) is retrieved by taking the real part of the product of the phasor and \(\mathrm{e}^{\mathrm{i} \omega t}\).
\begin{equation}
    \bm{E}(\bm{r}, t) = \Re \{\underline{\bm{E}}(\bm{r}) \mathrm{e}^{\mathrm{i} \omega t}\} = |\bm{E}(\bm{r})| \cos(\varphi(\bm{r}) + \omega t)
\end{equation}
For the phasor \(\underline{\bm{E}}(\bm{r})\) the time-reversal operator \(\mathcal{T}\) is simply a reflection along the real axis or (in mathematical terms) a negation of the phase.
Observing a monochromatic wave-signal along a ray-path through a system can be modelled by the phasor rotating counter-clockwise in the complex plane (see Figure~\ref{fig:phasor_propagation}).
Reflecting the phasor along the real axis will result in the same phasor as if the initial phasor was rotated clockwise while propagating through the system.
This way all the measured phasors at the receivers rotated back will align in the source-location and hence interfere constructively, resulting in a maximum of amplitude at this point (see Figure~\ref{fig:constructive_backpropagation}).  

\begin{figure}
    \centering
    \def\svgwidth{0.8\textwidth}
    \input{build/PhasorPropagation.pdf_tex}
    \caption{The phasor of a monochromatic wave-signal rotating counter-clockwise while propagating from a source (purple) to an array of receivers (green). How far the phasor is rotated is given by the phase of the system's transfer function \(\bm{H}(\bm{r}_{source}, \bm{r})\).}\label{fig:phasor_propagation}
\end{figure}

\begin{figure}
    \centering
    \def\svgwidth{0.8\textwidth}
    \input{build/ConstructiveBackpropagation.pdf_tex}
    \caption{Reflecting the received phasors along the real axis and propagating them back through the same system will make their phases align in the initial source location.}\label{fig:constructive_backpropagation}
\end{figure}

\begin{figure}
    \centering
    \def\svgwidth{0.8\textwidth}
    \input{build/DestructiveBackpropagation.pdf_tex}
    \caption{Sending the phasors back to another location than the original source location will in most cases not result in aligned phases.}\label{fig:destructive_backpropagation}
\end{figure}

In conclusion, measuring the far field with multiple sensors and subsequently calculating the field that would be created by antennas emitting the time-reversed signal from the measured locations will result in an amplitude distribution that is maximal at the source locations, which is also known as the principle of matched filtering.
This will then enable the localization of the sources. 
The corresponding imaging formula for \(N\) measurements \(E_i\) of monochromatic waves of frequency \(\omega \) at the locations \(\bm{r}_i\) is~\parencite{peng_zhang_comparison_2013}
\begin{equation}
    {I_{\omega}}^{\mathrm{\text{TR}}}\left(\bm{r}_p\right)=|\sum_{i=1}^N E_{i}^* G\left(\bm{r}_i, \bm{r}_p, \omega\right)|.
\end{equation}
In this formula \(G(\bm{r}_i, \bm{r}_p, \omega) = H_{i\rightarrow p}(\omega)\) represents the propagation of the wave from the source \(i\) to the imaging-point \(p\).
To improve the signal to noise ratio this imaging formula should be applied to multiple frequencies and the results should be summed up before taking the absolute value.
This can be interpreted as sending a dirac impulse into the system as the the Fourier transform of a dirac impulse is a constant function over all frequencies.
The summing up of the results for \(P\) different frequencies \(\omega_k\) is then an approximation to the integration over all frequencies and yields the final imaging formula
\begin{equation}
    I^{\mathrm{\text{TR}}}\left(\bm{r}_p\right)=|\sum_{k=1}^P \sum_{i=1}^N E_{i, k}^* G\left(\bm{r}_i, \bm{r}_p, \omega_k\right)|.
\end{equation}


\section{The Ray Concept of Electromagnetic Waves}\label{sec:ray-concept}
To utilize the imaging formula one needs to know the transfer-function \(H_{i\rightarrow p}(\omega)\) between every receiver and every imaging-point in the target-domain.
This could be done by full-wave simulations of delta-impulses at the measurement locations.
These simulations can be computationally expensive, especially for electrically large scenarios.
For this reason a geometric ray-tracing approach is taken to calculate these channel characteristics.
The following section will discuss the connection between Maxwell's equations and geometrical optics, to justify the use of rays for the calculation of the transfer-function, if the wavelength \(\lambda \sim \omega^{-1} \) is small enough compared to the dimensions of the objects involved.

\subsection{Deriving the Eikonal Equation from Maxwell's Equations}
The following argumentation is based on~\parencite{born_geometrische_1933} and~\parencite{sommerfeld_anwendung_1911}.
Consider a source-free (\(q(\bm{r}) = 0, \bm{J}(\bm{r}) = 0\)) and isotropic (\(\varepsilon(\bm{r}) = \varepsilon_0 \varepsilon_r(\bm{r}), \mu(\bm{r}) = \mu_0 \mu_r(\bm{r}) \)) medium with no free charges (\(\nabla \bm{E} = 0\)), where the permittivity and the permeability are piecewise constant.
Maxwell's equations can then be further simplified to the curl-curl-equation for the electric field
\begin{equation}
    \nabla \times (\nabla \times \bm{E}) = -\mu \varepsilon \frac{\partial^2}{\partial t^2} \bm{E}.
\end{equation}
Using Green's vector identity (\(\nabla \times (\nabla \times A) = \nabla(\nabla A) - \nabla^2 A\)), the wave equation for the electric field
\begin{equation}
    \nabla^2 \bm{E} - \mu \varepsilon \frac{\partial^2}{\partial t^2} \bm{E} = 0
\end{equation}
is obtained, where \(\nabla^2\) denotes the componential Laplacian operator.
The same equation can be derived for the magnetic field and holds for each single component \(\varphi \) of both fields.
For monochromatic waves of frequency \(\omega \) it can be written in the frequency domain as
\begin{equation}\label{electromagnetic_wave_equation}
    \nabla^2 \varphi(\bm{r}) + k_0^2\ n{(\bm{r})}^2 \varphi(\bm{r}) = 0,
\end{equation}
with \(k_0 = \omega \sqrt{\mu_0 \varepsilon_0} \) denoting the vacuum wave-number and \(n(\bm{r}) = \sqrt{\varepsilon_r(\bm{r}) \mu_r(\bm{r})}\) denoting the refractive index of the medium.
For a monochromatic wave of frequency \(\omega \) the components \(\varphi(\bm{r})\) can be described by the complex phasor \(\underline{\varphi}(\bm{r}) = A(\bm{r}) \mathrm{e}^{\mathrm{i} k_0 \psi(\bm{r})}\) with amplitude \(A(\bm{r})\) and phase \(k_0 \psi(\bm{r})\).
Equation~\eqref{electromagnetic_wave_equation} then converts to 
\begin{equation}\label{electromagnetic_wave_equation_complex}
    \nabla^2 A(\bm{r}) + 2\mathrm{i}k_0 \nabla A(\bm{r}) \cdot \nabla \psi(\bm{r}) + k_0^2 A(\bm{r}) ({n(\bm{r})}^2 - {(\nabla \psi(\bm{r}))}^2) = 0,
\end{equation}
with a more detailed derivation in Subsection~\ref{derivation}.

The transition from physical waves to geometrical optics is marked by the limit of \(k_0 \sim  \lambda^{-1} \rightarrow \infty \).
Dividing~\eqref{electromagnetic_wave_equation_complex} by \(k_0^2 A(\bm{r})\) and assuming that the amplitude is slowly varying, the limit \(k_0 \rightarrow \infty \) yields the Eikonal equation
\begin{equation}
    {n(\bm{r})}^2 - {(\nabla \psi(\bm{r}))}^2 = 0 \quad \Leftrightarrow \quad n(\bm{r}) = ||\nabla \psi(\bm{r})||.
\end{equation}


\subsection{The Differential Equation of Rays}
Wavefronts are surfaces of constant phase \(\psi(\bm{r})\).
Rays are defined as the orthogonal trajectories of the wavefronts and can be written as curves
\begin{equation}
    \bm{r}(l) = \bm{r}_0 + \int_{0}^{l} \bm{v}(\bm{r}(l^{\prime})) \, dl^{\prime},
\end{equation}
with the unit-ray-vector \(\bm{v}(\bm{r}) = \nabla \psi(\bm{r}) / ||\nabla \psi(\bm{r})||\).
Combining the Eikonal equation with the definition of the unit-ray-vector yields
\begin{equation}\label{ray-differential-equation}
    n(\bm{r}) \bm{v}(\bm{r}) = \nabla \psi(\bm{r}).
\end{equation}
Considering the identities \(\nabla(A^2)= 2 A \nabla A\) and \(\nabla[{(\nabla A)}^2] = 2 \nabla A \nabla^2 A\) and deriving equation~\eqref{ray-differential-equation} with respect to \(l\) results in the differential equation of rays~\parencite{born_foundations_1999}:
\begin{align}
    \frac{d}{dl}(n(\bm{r}) \bm{v}(\bm{r})) &= \frac{d}{dl}(\nabla \psi(\bm{r})) = \nabla^2 \psi(\bm{r}) \frac{d\bm{r}}{dl} \nonumber \\
    &= \nabla^2 \psi(\bm{r}) \bm{v}(\bm{r}) = \nabla^2 \psi(\bm{r}) \nabla \psi(\bm{r}) \frac{1}{n(\bm{r})} \nonumber \\
    &= \frac{1}{2n(\bm{r})} \nabla[{(\nabla \psi)}^2] = \frac{1}{2n(\bm{r})} \nabla({n(\bm{r})}^2) \nonumber \\
    &= \nabla n(\bm{r})
\end{align}
For a ray in a homogenous medium, i.e.~\(n(\bm{r}) = n_0\), this equation becomes
\begin{equation}
    n_0 \frac{d}{dl}\bm{v}(\bm{r}) = 0,
\end{equation}
so the unit-ray-vector is a constant and hence the ray is a straight line:
\begin{equation}
    \bm{r}(l) = \bm{r}_0 + l \bm{v}_0
\end{equation}


\subsection{Refraction and Reflection at Plane Interfaces}
At a plane interface \(\Gamma \) of two homogenous media (\(\Lambda_1\) and \(\Lambda_2\)) with different refractive indices \(n_1\) and \(n_2\), the differential equation of rays must be fulfilled.
An incident ray with unit-vector \(\bm{v}_1\) and the transmitted ray with unit-vector \(\bm{v}_2\) therefore satisfy the following conditions at any point on the interface:
\begin{equation}
    n_1 \bm{v}_1 = \nabla \psi|_{r \in \Lambda_1 } \quad n_2 \bm{v}_2 = \nabla \psi|_{r \in \Lambda_2 } 
\end{equation}
The closed integral over a gradient field is always zero.
For any rectangular curve \(C\) (width \(w\) and height \(h\)) where the edges of length \(w\) are tangential to \(\Gamma \) the integral of the gradient field must still be zero.
The tangential parts of the curve are either in \(\Lambda_1\) or \(\Lambda_2\).
Taking the limit of \(h \to 0\) then results in~\parencite{born_foundations_1999}
\begin{equation}
    \lim_{h \to 0} \oint_C \nabla \psi \cdot d\bm{r} = \int_{0}^{w} \nabla \psi|_{r \in \Lambda_1 } \cdot \bm{t} \, dw' + \int_{0}^{w} \nabla \psi|_{r \in \Lambda_2 } \cdot (-\bm{t}) \, dw' = 0.
\end{equation}
This means that the tangential components of the ray-vectors \(n \cdot \bm{v}\) are continuous across the interface:
\begin{equation}
    (n_2 \bm{v}_2 - n_1 \bm{v}_1) \cdot \bm{t} = 0
\end{equation}
With \(\bm{t} = \bm{b} \times \bm{n}\), where \(\bm{n}\) is the normal vector of \(\Gamma \) and \(\bm{b}\) is the normal vector of the plane where \(C\) lies, this becomes
\begin{equation}
    \bm{b} \cdot [\bm{n} \times (n_2 \bm{v}_2 - n_1 \bm{v}_1)] = 0.
\end{equation}
This equation holds for an arbitrary orientation of the curve \(C\) as long as the edges of length \(w\) are completely in either \(\Lambda_1\) or \(\Lambda_2\).
This implies that \(\bm{b}\) can be chosen arbitrarily as long as \(\bm{t} = \bm{b} \times \bm{n}\) still holds.
With this in mind and \(\theta_1\),\(\theta_2\) denoting the angles of \(\bm{v}_1\),\(\bm{v}_2\) with the surface normal \(\bm{n}\), Snell's law is retrieved by
\begin{equation}
    \bm{n} \times (n_2\bm{v}_2) - \bm{n} \times (n_1\bm{v}_1) = 0 \quad \Rightarrow \quad n_1 \sin(\theta_1) = n_2 \sin(\theta_2).
\end{equation}

It is known, that at the transition between two media with different refractive indices there is always a refracted as well as a reflected wave.
The reflected wave is in the same medium as the incident wave, which leads to the law of specular reflection:
\begin{equation}
    \sin(\theta_{\text{inc}}) = \sin(\theta_{\text{ref}}).
\end{equation}


\subsection{Phase and Amplitude Propagation along Ray-Paths}
According to the definition of the ray-path \(\bm{r}(l)\) and the Eikonal equation, the derivation of the phase \(k_0 \psi(\bm{r})\) of a wave along this path is always equal to \(k_0\) times the refractive index \(n(\bm{r})\) so the phase propagation can be written as
\begin{equation}
    k_0 \psi(\bm{r}(l)) = k_0 \int_{0}^{l} n(\bm{r}(l^{\prime})) \, dl^{\prime}.
\end{equation}
In a homogenous medium this simplifies to
\begin{equation}
    k_0 \psi(\bm{r}(l)) = k_0 n l.
\end{equation}

The amplitude propagation on the other hand is approximated under the far-field condition.
This condition is fulfilled if the distance from the source is much larger than the wavelength of the wave.
For a single point-source in a lossless medium the radiated energy is conserved so the integral over the Poynting-Vector \(\bm{S}\) over a sphere \(\mathcal{S} \) of radius \(r\) must be independent of \(r\), which is expressed as
\begin{equation}
    \int_\mathcal{S}  \bm{S} \cdot \bm{n} \, d\Omega = |\bm{S}| 4\pi r^2 = \text{const}.
\end{equation}
This means, the amplitude of \(\bm{S}\) is inversely proportional to the square of the distance from the source in the far-field.
The amplitude of the Poynting-Vector is furthermore proportional to the amplitude of the electric field squared, which concludes that the amplitude of the electric field is inversely proportional to the distance from the source:
\begin{equation}
    |\bm{E}| \propto \frac{1}{r}
\end{equation}
In scenarios like the reflection at interfaces, the amplitude and direction of the electric field vector can be calculated by the Fresnel equations, where the polarization of the field is considered as well.
For our case it is sufficient to model a reflective surface with a virtual source that is placed in the mirrored position of the original source with respect to the surface, so the reflected ray's amplitude keeps decreasing with \(\frac{1}{l}\), where \(l\) is the distance from the virtual source.
If the scenario is even more complex, for example curved reflective surfaces, or sharp edges, a more sophisticated model would be needed.

With these limitations in mind, the propagation of the electric field along a straight ray-path \(\bm{r}(l)\) from a source \(\underline{\bm{E}}_0\) through a homogenous medium (refractive index \(n\)) can be described as
\begin{equation} \label{eq:field-along-ray-path}
    \underline{\bm{E}}(l) = \frac{1}{1 + l} \underline{\bm{E}}_0 \mathrm{e}^{\mathrm{i} k_0 n l},
\end{equation}
with \(l\) denoting the distance from the source.
The factor \(\frac{1}{1 + l}\) is chosen so the decay of the amplitude is inversely proportional to \(l\) and  \(\underline{\bm{E}}(0) = \underline{\bm{E}}_0 \)




\subsection{Derivation of the Monochromatic Electromagnetic Wave Equation}\label{derivation}
The electromagnetic wave equation in the frequency domain is given in~\eqref{electromagnetic_wave_equation} as
\begin{equation}
    \nabla^2 \underline{\varphi}(\bm{r}) + k_0^2\ n{(\bm{r})}^2 \underline{\varphi}(\bm{r}) \stackrel{!}{=} 0.
\end{equation}
The monochromatic wave is defined by the complex phasor \(\underline{\varphi}(\bm{r}) = A(\bm{r}) \mathrm{e}^{\mathrm{i}k_0 \psi(\bm{r})}\).
Considering the following identities
\begin{align}
    \nabla^2 (a b) &= \nabla^2 a b + 2 (\nabla a \cdot \nabla b) + a \nabla^2 b, \\
    \nabla \mathrm{e}^{\mathrm{i} k_0 \psi(\bm{r})} &= i k_0 \nabla \psi(\bm{r}) \mathrm{e}^{\mathrm{i} k_0 \psi(\bm{r})}, \\
    \nabla^2 \mathrm{e}^{\mathrm{i} k_0 \psi(\bm{r})} &= - k_0^2 {(\nabla \psi(\bm{r}))}^2 \mathrm{e}^{\mathrm{i} k_0 \psi(\bm{r})},
\end{align}
leads to
\begin{align}
    \nabla^2 \underline{\varphi}(\bm{r}) &=\nabla^2 (A(\bm{r}) \mathrm{e}^{\mathrm{i}k_0 \psi(\bm{r})}) \nonumber \\
                                        &= (\nabla^2 A(\bm{r}) + 2\mathrm{i}k_0 \nabla A(\bm{r}) \cdot \nabla \psi(\bm{r}) - k_0^2 (\nabla \psi(\bm{r}))) \mathrm{e}^{\mathrm{i}k_0 \psi(\bm{r})}
\end{align}
which results in the following equivalence
\begin{gather}
    \nabla^2 \underline{\varphi}(\bm{r}) + k_0^2\ n{(\bm{r})}^2 \underline{\varphi}(\bm{r}) \stackrel{!}{=} 0 \\
    \Leftrightarrow \nabla^2 A(\bm{r}) + 2\mathrm{i}k_0 \nabla A(\bm{r}) \cdot \nabla \psi(\bm{r}) + k_0^2 A(\bm{r}) ({n(\bm{r})}^2 - {(\nabla \psi(\bm{r}))}^2) \stackrel{!}{=} 0.
\end{gather}